var bt=Object.defineProperty;var Tt=(t,e,n)=>e in t?bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var R=(t,e,n)=>Tt(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();var ce,y,Qe,Ye,$,xe,je,he,Ae,pe,ye,z={},ze=[],Ot=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Le=Array.isArray;function H(t,e){for(var n in e)t[n]=e[n];return t}function Ze(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ct(t,e,n){var i,o,r,u={};for(r in e)r=="key"?i=e[r]:r=="ref"?o=e[r]:u[r]=e[r];if(arguments.length>2&&(u.children=arguments.length>3?ce.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)u[r]===void 0&&(u[r]=t.defaultProps[r]);return oe(t,u,i,o,null)}function oe(t,e,n,i,o){var r={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:o??++Qe,__i:-1,__u:0};return o==null&&y.vnode!=null&&y.vnode(r),r}function de(t){return t.children}function Y(t,e){this.props=t,this.context=e}function V(t,e){if(e==null)return t.__?V(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?V(t):null}function Je(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Je(t)}}function Ee(t){(!t.__d&&(t.__d=!0)&&$.push(t)&&!ue.__r++||xe!==y.debounceRendering)&&((xe=y.debounceRendering)||je)(ue)}function ue(){var t,e,n,i,o,r,u,a;for($.sort(he);t=$.shift();)t.__d&&(e=$.length,i=void 0,r=(o=(n=t).__v).__e,u=[],a=[],n.__P&&((i=H({},o)).__v=o.__v+1,y.vnode&&y.vnode(i),ke(n.__P,i,o,n.__n,n.__P.namespaceURI,32&o.__u?[r]:null,u,r??V(o),!!(32&o.__u),a),i.__v=o.__v,i.__.__k[i.__i]=i,et(u,i,a),i.__e!=r&&Je(i)),$.length>e&&$.sort(he));ue.__r=0}function Xe(t,e,n,i,o,r,u,a,c,d,h){var s,m,v,S,P,b=i&&i.__k||ze,A=e.length;for(n.__d=c,Mt(n,e,b),c=n.__d,s=0;s<A;s++)(v=n.__k[s])!=null&&(m=v.__i===-1?z:b[v.__i]||z,v.__i=s,ke(t,v,m,o,r,u,a,c,d,h),S=v.__e,v.ref&&m.ref!=v.ref&&(m.ref&&De(m.ref,null,v),h.push(v.ref,v.__c||S,v)),P==null&&S!=null&&(P=S),65536&v.__u||m.__k===v.__k?c=Ke(v,c,t):typeof v.type=="function"&&v.__d!==void 0?c=v.__d:S&&(c=S.nextSibling),v.__d=void 0,v.__u&=-196609);n.__d=c,n.__e=P}function Mt(t,e,n){var i,o,r,u,a,c=e.length,d=n.length,h=d,s=0;for(t.__k=[],i=0;i<c;i++)(o=e[i])!=null&&typeof o!="boolean"&&typeof o!="function"?(u=i+s,(o=t.__k[i]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?oe(null,o,null,null,null):Le(o)?oe(de,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?oe(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,r=null,(a=o.__i=Pt(o,n,u,h))!==-1&&(h--,(r=n[a])&&(r.__u|=131072)),r==null||r.__v===null?(a==-1&&s--,typeof o.type!="function"&&(o.__u|=65536)):a!==u&&(a==u-1?s--:a==u+1?s++:(a>u?s--:s++,o.__u|=65536))):o=t.__k[i]=null;if(h)for(i=0;i<d;i++)(r=n[i])!=null&&!(131072&r.__u)&&(r.__e==t.__d&&(t.__d=V(r)),tt(r,r))}function Ke(t,e,n){var i,o;if(typeof t.type=="function"){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,e=Ke(i[o],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=V(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Pt(t,e,n,i){var o=t.key,r=t.type,u=n-1,a=n+1,c=e[n];if(c===null||c&&o==c.key&&r===c.type&&!(131072&c.__u))return n;if(i>(c!=null&&!(131072&c.__u)?1:0))for(;u>=0||a<e.length;){if(u>=0){if((c=e[u])&&!(131072&c.__u)&&o==c.key&&r===c.type)return u;u--}if(a<e.length){if((c=e[a])&&!(131072&c.__u)&&o==c.key&&r===c.type)return a;a++}}return-1}function Ne(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Ot.test(e)?n:n+"px"}function te(t,e,n,i,o){var r;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||Ne(t.style,e,"");if(n)for(e in n)i&&n[e]===i[e]||Ne(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")r=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+r]=n,n?i?n.u=i.u:(n.u=Ae,t.addEventListener(e,r?ye:pe,r)):t.removeEventListener(e,r?ye:pe,r);else{if(o=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function He(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Ae++;else if(e.t<n.u)return;return n(y.event?y.event(e):e)}}}function ke(t,e,n,i,o,r,u,a,c,d){var h,s,m,v,S,P,b,A,L,q,E,X,B,we,K,fe,w=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(c=!!(32&n.__u),r=[a=e.__e=n.__e]),(h=y.__b)&&h(e);e:if(typeof w=="function")try{if(A=e.props,L="prototype"in w&&w.prototype.render,q=(h=w.contextType)&&i[h.__c],E=h?q?q.props.value:h.__:i,n.__c?b=(s=e.__c=n.__c).__=s.__E:(L?e.__c=s=new w(A,E):(e.__c=s=new Y(A,E),s.constructor=w,s.render=xt),q&&q.sub(s),s.props=A,s.state||(s.state={}),s.context=E,s.__n=i,m=s.__d=!0,s.__h=[],s._sb=[]),L&&s.__s==null&&(s.__s=s.state),L&&w.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=H({},s.__s)),H(s.__s,w.getDerivedStateFromProps(A,s.__s))),v=s.props,S=s.state,s.__v=e,m)L&&w.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),L&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(L&&w.getDerivedStateFromProps==null&&A!==v&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(A,E),!s.__e&&(s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(A,s.__s,E)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(s.props=A,s.state=s.__s,s.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(ee){ee&&(ee.__=e)}),X=0;X<s._sb.length;X++)s.__h.push(s._sb[X]);s._sb=[],s.__h.length&&u.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(A,s.__s,E),L&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(v,S,P)})}if(s.context=E,s.props=A,s.__P=t,s.__e=!1,B=y.__r,we=0,L){for(s.state=s.__s,s.__d=!1,B&&B(e),h=s.render(s.props,s.state,s.context),K=0;K<s._sb.length;K++)s.__h.push(s._sb[K]);s._sb=[]}else do s.__d=!1,B&&B(e),h=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++we<25);s.state=s.__s,s.getChildContext!=null&&(i=H(H({},i),s.getChildContext())),L&&!m&&s.getSnapshotBeforeUpdate!=null&&(P=s.getSnapshotBeforeUpdate(v,S)),Xe(t,Le(fe=h!=null&&h.type===de&&h.key==null?h.props.children:h)?fe:[fe],e,n,i,o,r,u,a,c,d),s.base=e.__e,e.__u&=-161,s.__h.length&&u.push(s),b&&(s.__E=s.__=null)}catch(ee){if(e.__v=null,c||r!=null){for(e.__u|=c?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,e.__e=a}else e.__e=n.__e,e.__k=n.__k;y.__e(ee,e,n)}else r==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=wt(n.__e,e,n,i,o,r,u,c,d);(h=y.diffed)&&h(e)}function et(t,e,n){e.__d=void 0;for(var i=0;i<n.length;i++)De(n[i],n[++i],n[++i]);y.__c&&y.__c(e,t),t.some(function(o){try{t=o.__h,o.__h=[],t.some(function(r){r.call(o)})}catch(r){y.__e(r,o.__v)}})}function wt(t,e,n,i,o,r,u,a,c){var d,h,s,m,v,S,P,b=n.props,A=e.props,L=e.type;if(L==="svg"?o="http://www.w3.org/2000/svg":L==="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((v=r[d])&&"setAttribute"in v==!!L&&(L?v.localName===L:v.nodeType===3)){t=v,r[d]=null;break}}if(t==null){if(L===null)return document.createTextNode(A);t=document.createElementNS(o,L,A.is&&A),a&&(y.__m&&y.__m(e,r),a=!1),r=null}if(L===null)b===A||a&&t.data===A||(t.data=A);else{if(r=r&&ce.call(t.childNodes),b=n.props||z,!a&&r!=null)for(b={},d=0;d<t.attributes.length;d++)b[(v=t.attributes[d]).name]=v.value;for(d in b)if(v=b[d],d!="children"){if(d=="dangerouslySetInnerHTML")s=v;else if(!(d in A)){if(d=="value"&&"defaultValue"in A||d=="checked"&&"defaultChecked"in A)continue;te(t,d,null,v,o)}}for(d in A)v=A[d],d=="children"?m=v:d=="dangerouslySetInnerHTML"?h=v:d=="value"?S=v:d=="checked"?P=v:a&&typeof v!="function"||b[d]===v||te(t,d,v,b[d],o);if(h)a||s&&(h.__html===s.__html||h.__html===t.innerHTML)||(t.innerHTML=h.__html),e.__k=[];else if(s&&(t.innerHTML=""),Xe(t,Le(m)?m:[m],e,n,i,L==="foreignObject"?"http://www.w3.org/1999/xhtml":o,r,u,r?r[0]:n.__k&&V(n,0),a,c),r!=null)for(d=r.length;d--;)Ze(r[d]);a||(d="value",L==="progress"&&S==null?t.removeAttribute("value"):S!==void 0&&(S!==t[d]||L==="progress"&&!S||L==="option"&&S!==b[d])&&te(t,d,S,b[d],o),d="checked",P!==void 0&&P!==t[d]&&te(t,d,P,b[d],o))}return t}function De(t,e,n){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&e==null||(t.__u=t(e))}else t.current=e}catch(o){y.__e(o,n)}}function tt(t,e,n){var i,o;if(y.unmount&&y.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||De(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){y.__e(r,e)}i.base=i.__P=null}if(i=t.__k)for(o=0;o<i.length;o++)i[o]&&tt(i[o],e,n||typeof t.type!="function");n||Ze(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function xt(t,e,n){return this.constructor(t,n)}function Et(t,e,n){var i,o,r,u;y.__&&y.__(t,e),o=(i=typeof n=="function")?null:e.__k,r=[],u=[],ke(e,t=(!i&&n||e).__k=Ct(de,null,[t]),o||z,z,e.namespaceURI,!i&&n?[n]:o?null:e.firstChild?ce.call(e.childNodes):null,r,!i&&n?n:o?o.__e:e.firstChild,i,u),et(r,t,u)}ce=ze.slice,y={__e:function(t,e,n,i){for(var o,r,u;e=e.__;)if((o=e.__c)&&!o.__)try{if((r=o.constructor)&&r.getDerivedStateFromError!=null&&(o.setState(r.getDerivedStateFromError(t)),u=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(t,i||{}),u=o.__d),u)return o.__E=o}catch(a){t=a}throw t}},Qe=0,Ye=function(t){return t!=null&&t.constructor==null},Y.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=H({},this.state),typeof t=="function"&&(t=t(H({},n),this.props)),t&&H(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Ee(this))},Y.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ee(this))},Y.prototype.render=de,$=[],je=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,he=function(t,e){return t.__v.__b-e.__v.__b},ue.__r=0,Ae=0,pe=He(!1),ye=He(!0);var Nt=0;function l(t,e,n,i,o,r){e||(e={});var u,a,c=e;if("ref"in c)for(a in c={},e)a=="ref"?u=e[a]:c[a]=e[a];var d={type:t,props:c,key:n,ref:u,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--Nt,__i:-1,__u:0,__source:o,__self:r};if(typeof t=="function"&&(u=t.defaultProps))for(a in u)c[a]===void 0&&(c[a]=u[a]);return y.vnode&&y.vnode(d),d}function Z(t){throw"never"}const N=class N{static NoteOn(e,n,i){return[N.NoteOnCode|e-1,n,i]}static NoteOff(e,n,i){return[N.NoteOffCode|e-1,n,i]}static ControlChange(e,n,i){return[N.ControlChangeCode|e-1,n,i]}};R(N,"NoteOnCode",144),R(N,"NoteOffCode",128),R(N,"ControlChangeCode",176);let D=N;function be(t,e){if(t!==void 0)for(const n of t.outputs){const i=n[1];if(i.name===e)return i}}const nt={SIZ:{x:4,y:4,relative:!0},MUL:{x:5,y:4,relative:!0},WRP:{x:6,y:4,relative:!0},SCN:{x:7,y:4,relative:!0},OSC:{x:7,y:4,relative:!1}},it={FM1:{x:4,y:4,relative:!0},FM2:{x:5,y:4,relative:!0},FM3:{x:6,y:4,relative:!0},FM4:{x:7,y:4,relative:!0}},ot={SHF:{x:4,y:4,relative:!0},SWM:{x:5,y:4,relative:!0},WID:{x:6,y:4,relative:!0},SUB:{x:7,y:4,relative:!0}},rt={PLY:{x:3,y:4,relative:!1},STA:{x:4,y:4,relative:!1},LOP:{x:5,y:4,relative:!0},LEN:{x:6,y:4,relative:!0},DEG:{x:7,y:4,relative:!0},SLI:{x:6,y:5,relative:!1}},ut={TBR:{x:4,y:4,relative:!0},COL:{x:5,y:4,relative:!0},DEG:{x:6,y:4,relative:!0},RED:{x:7,y:4,relative:!0},OSC:{x:7,y:4,relative:!1}},st={DEL:{x:3,y:0,relative:!1},HOP:{x:5,y:0,relative:!1},RET:{x:0,y:1,relative:!1},REP:{x:1,y:1,relative:!1},RTO:{x:2,y:1,relative:!1},TIC:{x:6,y:2,relative:!1}},lt={VOL:{x:0,y:4,relative:!0},PIT:{x:1,y:4,relative:!0},FIN:{x:2,y:4,relative:!0},CUT:{x:1,y:5,relative:!0},RES:{x:2,y:5,relative:!0},AMP:{x:3,y:5,relative:!0},PAN:{x:5,y:5,relative:!0},DRY:{x:0,y:6,relative:!1},SCH:{x:1,y:6,relative:!1},SDL:{x:2,y:6,relative:!1},SRV:{x:3,y:6,relative:!1}},Ht={SIZ:{ty:"WAV",code:"SIZ",value:0},MUL:{ty:"WAV",code:"MUL",value:0},WRP:{ty:"WAV",code:"WRP",value:0},SCN:{ty:"WAV",code:"SCN",value:0},OSC:{ty:"WAV",code:"OSC",value:0}},Rt={FM1:{ty:"FM",code:"FM1",value:0},FM2:{ty:"FM",code:"FM2",value:0},FM3:{ty:"FM",code:"FM3",value:0},FM4:{ty:"FM",code:"FM4",value:0}},$t={SHF:{ty:"HS",code:"SHF",value:0},SWM:{ty:"HS",code:"SWM",value:0},WID:{ty:"HS",code:"WID",value:0},SUB:{ty:"HS",code:"SUB",value:0}},Ft={PLY:{ty:"SA",code:"PLY",value:0},STA:{ty:"SA",code:"STA",value:0},LOP:{ty:"SA",code:"LOP",value:0},LEN:{ty:"SA",code:"LEN",value:0},DEG:{ty:"SA",code:"DEG",value:0},SLI:{ty:"SA",code:"SLI",value:0}},It={TBR:{ty:"MA",code:"TBR",value:0},COL:{ty:"MA",code:"COL",value:0},DEG:{ty:"MA",code:"DEG",value:0},RED:{ty:"MA",code:"RED",value:0},OSC:{ty:"MA",code:"OSC",value:0}},Q={VOL:{ty:"GLO",code:"VOL",value:0},PIT:{ty:"GLO",code:"PIT",value:0},FIN:{ty:"GLO",code:"FIN",value:0},CUT:{ty:"GLO",code:"CUT",value:0},RES:{ty:"GLO",code:"RES",value:0},AMP:{ty:"GLO",code:"AMP",value:0},PAN:{ty:"GLO",code:"PAN",value:0},DRY:{ty:"GLO",code:"DRY",value:0},SCH:{ty:"GLO",code:"SCH",value:0},SDL:{ty:"GLO",code:"SDL",value:0},SRV:{ty:"GLO",code:"SRV",value:0}},Ut=["WAV","FM","MA","HS","SA"];function Vt(t){if(t===null)return;const e=Ut.find(n=>n===t);return e||void 0}const at={WAV:"Wavsynth",MA:"Macrosynth",HS:"Hypersynth",SA:"Sampler",FM:"FM Synth"};function Wt(t){const e=t.ty;switch(e){case"SEQ":return"Sequencer";case"GLO":return"Global";default:return at[e]}}class f{static DEL(e){return{ty:"SEQ",code:"DEL",value:e}}static REP(e){return{ty:"SEQ",code:"REP",value:e}}static HOP(e){return{ty:"SEQ",code:"HOP",value:e}}static CUT(e){return{ty:"GLO",code:"CUT",value:e}}}function*x(t){for(let e in t)yield t[e]}const ct={WAV:[[...x(Ht)],[...x(Q)]],FM:[[...x(Rt)],[...x(Q)]],MA:[[...x(It)],[...x(Q)]],HS:[[...x($t)],[...x(Q)]],SA:[[...x(Ft)],[...x(Q)]]};function Gt(t,e,n){let i=0,o=0,r=e,u=0;const a=3,c=2,d=t.canvas.clientHeight,h=m=>{t.fillRect(o*a,d-m,a,c)},s=t.canvas.clientWidth/a;for(;i<n.length&&!(o>=s);){const m=n[i];switch(m.code){case"REP":for(let S=0;S<m.value&&!(o>=s);S++)r=Math.min(255,Math.max(0,r+u)),h(r),o++;break;case"DEL":for(let S=0;S<m.value&&!(o>=s);S++)h(r),o++;break;case"HOP":m.value===i&&(h(r),o++),i=m.value-1;break;default:if(I(m)){const S=m.value>128?-(~m.value+1&255):m.value;r=S+r,u=S}else r=m.value,u=r;r=Math.min(255,Math.max(0,r)),h(r),o++;break}i++}for(;o<s;)h(r),o++}function I(t){switch(t.ty){case"SEQ":return st[t.code].relative;case"GLO":return lt[t.code].relative;case"WAV":return nt[t.code].relative;case"FM":return it[t.code].relative;case"MA":return ut[t.code].relative;case"HS":return ot[t.code].relative;case"SA":return rt[t.code].relative;default:return Z()}}function qt(t){switch(t.ty){case"SEQ":return st[t.code];case"GLO":return lt[t.code];case"WAV":return nt[t.code];case"FM":return it[t.code];case"MA":return ut[t.code];case"HS":return ot[t.code];case"SA":return rt[t.code];default:return Z()}}function*Bt(){for(let t=0;t<7;t++)yield 4,yield 4;for(let t=0;t<15;t++)yield 6,yield 6}function*Qt(t){yield 2,yield 3,yield 2,yield 3,yield 2;const e=(t/16|0)*2;for(let i=0;i<e;i++)yield 6;const n=(t&15)*2;for(let i=0;i<n;i++)yield 5;yield 2}function*Yt(t){const e={x:0,y:0};let n=!0;for(const i of t){const o=qt(i),r=o.x-e.x,u=o.y-e.y,a=r<0?4:5,c=u<0?6:7;yield 2,yield 6,yield 6,n&&(yield*Bt(),n=!1);const d=Math.abs(r);for(let s=0;s<2*d;s++)yield a;const h=Math.abs(u);for(let s=0;s<2*h;s++)yield c;yield 2,yield 5,yield 5,yield*Qt(i.value),yield 4,yield 4,yield 7,yield 7,e.x=o.x,e.y=o.y}}class dt{constructor(e){R(this,"NoteOns");R(this,"NoteOffs");R(this,"keyStates");this.controlChannel=e,this.keyStates=[!1,!1,!1,!1,!1,!1,!1,!1],this.NoteOns=[D.NoteOn(e,0,1),D.NoteOn(e,1,1),D.NoteOn(e,2,1),D.NoteOn(e,3,1),D.NoteOn(e,4,1),D.NoteOn(e,5,1),D.NoteOn(e,6,1),D.NoteOn(e,7,1)],this.NoteOffs=[D.NoteOff(e,0,0),D.NoteOff(e,1,0),D.NoteOff(e,2,0),D.NoteOff(e,3,0),D.NoteOff(e,4,0),D.NoteOff(e,5,0),D.NoteOff(e,6,0),D.NoteOff(e,7,0)]}sendCCs(e,n,i,o){const u=D.ControlChange(this.controlChannel,n,i);for(let a=0;a<o;a++)e.send(u,window.performance.now()+a*300)}sendCommands(e,n){this.sendUserCommands(e,Yt(n))}sendUserCommands(e,n){let i=0;const o=23;for(const r of n){const u=this.keyStates[r],a=u?this.NoteOffs:this.NoteOns;this.keyStates[r]=!u,e.send(a[r],window.performance.now()+i*o),i++}}}async function jt(t,e,n){await t.open(),new dt(e).sendCommands(t,n)}async function zt(t,e,n,i,o){await t.open(),new dt(n).sendCCs(t,i,o,e)}function*Zt(t,e){if(!I(t)){yield*Te(t,{Segments:[{Amount:e.Amount,TicDuration:e.AttackTics},{Amount:-e.Amount,TicDuration:e.DecayTics}],Loop:e.Loop});return}let n=0;if(e.AttackTics===0)yield{...t,value:e.Amount},n++;else{const i=e.Amount/e.AttackTics|0;yield{...t,value:i},n++,e.AttackTics>1&&(yield f.REP(e.AttackTics-1),n++)}if(e.DecayTics===0)yield{...t,value:M(e.Amount)},n++;else{const i=e.Amount/e.DecayTics|0;yield{...t,value:M(i)},n++,e.DecayTics>1&&(n++,yield f.REP(e.DecayTics-1))}e.Loop?yield f.HOP(0):yield f.HOP(n)}function*Jt(t,e){let n=0;if(e.AttackTics===0)yield{...t,value:e.Amount},n++;else{const o=e.Amount/e.AttackTics|0;yield{...t,value:o},n++,e.AttackTics>1&&(yield f.REP(e.AttackTics-1),n++)}const i=e.Amount-e.SustainLevel;if(e.DecayTics===0)yield{...t,value:M(i)},n++;else{const o=i/e.DecayTics|0;yield{...t,value:M(o)},n++,e.DecayTics>1&&(n++,yield f.REP(e.DecayTics-1))}if(yield f.DEL(e.SustainTics),n++,e.ReleaseTics>0){const o=e.SustainLevel/e.ReleaseTics|0;yield{...t,value:M(o)},n++,e.ReleaseTics>1&&(n++,yield f.REP(e.ReleaseTics-1))}else yield{...t,value:M(e.SustainLevel)},n++;e.Loop?yield f.HOP(0):yield f.HOP(n)}function M(t){return(255-t+1)%256}function*Xt(t,e){const n=e.Duration/4|0,i=e.Duration/2|0;if(!I(t)){yield*Te(t,{Segments:[{Amount:e.Amount/2|0,TicDuration:n},{Amount:-e.Amount,TicDuration:i},{Amount:e.Amount/2|0,TicDuration:n}],Loop:e.Loop});return}const o=e.Amount/(e.Duration/2)|0;let r=3;yield{...t,value:o},n>1&&(yield f.REP(n-1),r++),yield{...t,value:M(o)},i>1&&(yield f.REP(i-1),r++),yield{...t,value:o},n>1&&(yield f.REP(n-1),r++),e.Loop?yield f.HOP(0):yield f.HOP(r)}function*Kt(t,e){const n=e.Duration/2|0;let i=1;if(I(t))yield{...t,value:e.Amount/2|0},n>1&&(yield f.DEL(n-1),i++),i++,yield{...t,value:M(e.Amount)},n>1&&(i++,yield f.DEL(n-1)),i++,yield{...t,value:e.Amount},n>1&&(i++,yield f.DEL(n-1)),e.Loop?yield f.HOP(n>1?2:1):yield f.HOP(i);else{const o=t.value;yield{...t,value:Math.min(255,o+e.Amount/2|0)},n>1&&(yield f.DEL(n-1),i++),i++,yield{...t,value:Math.max(0,o-e.Amount/2|0)},n>1&&(i++,yield f.DEL(n-1)),e.Loop?yield f.HOP(0):yield f.HOP(i)}}function*en(t,e){let n=2;if(I(t)){const i=e.Amount/e.Duration|0;yield{...t,value:i},e.Duration>1&&(yield f.REP(e.Duration),n++),e.Loop?(yield{...t,value:M(e.Amount)},yield f.HOP(0)):yield f.HOP(n)}else if(e.Duration<=15){for(let i=0;i<e.Duration;i++)yield{...t,value:t.value+e.Amount*i/e.Duration|0};e.Loop?yield f.HOP(0):yield f.HOP(e.Duration)}else{const o=e.Duration/7;let r=o;for(let u=0;u<7;u++)yield{...t,value:t.value+e.Amount*u/7|0},n++,(r|0)>=1&&(n++,yield f.DEL(r|0),r=r-(r|0)),r+=o;e.Loop?yield f.HOP(0):yield f.HOP(n)}}function*tn(t,e){let n=2;if(I(t)){const i=e.Amount/e.Duration|0;yield{...t,value:e.Amount},yield{...t,value:M(i)},e.Duration>1&&(yield f.REP(e.Duration),n++),e.Loop?yield f.HOP(0):yield f.HOP(n)}else if(e.Duration<=15){for(let i=e.Duration-1;i>=0;i--)yield{...t,value:t.value+e.Amount*i/e.Duration|0};e.Loop?yield f.HOP(0):yield f.HOP(e.Duration)}else{const o=e.Duration/7;let r=o;for(let u=6;u>=0;u--)yield{...t,value:t.value+e.Amount*u/7|0},n++,(r|0)>=1&&(n++,yield f.DEL(r|0),r=r-(r|0)),r+=o;e.Loop?yield f.HOP(0):yield f.HOP(n)}}function*Te(t,e){let n=0;if(I(t)){for(const i of e.Segments)if(i.TicDuration<=1)yield{...t,value:i.Amount<0?M(i.Amount):i.Amount|0},n++;else if(i.Amount!==0){const r=(i.Amount<0?Math.abs(i.Amount):i.Amount)/i.TicDuration|0,u=i.Amount<0?M(r):r;yield{...t,value:u},yield f.REP(i.TicDuration-1),n+=2}else yield f.DEL(i.TicDuration);e.Loop?yield f.HOP(0):yield f.HOP(n)}else{const i=e.Segments.reduce((r,u)=>r+(u.Amount===0?1:u.TicDuration),0);let o=t.value;if(i<=15){for(const r of e.Segments)if(r.TicDuration<=1)o+=r.Amount,yield{...t,value:o},n++;else if(r.Amount!==0){const u=r.Amount/r.TicDuration|0;for(let a=0;a<r.TicDuration;a++)o+=u,yield{...t,value:o|0},n++}else yield f.DEL(r.TicDuration),n++;e.Loop?yield f.HOP(0):yield f.HOP(n)}else{for(const r of e.Segments){if(n>=13)break;const u=r.TicDuration*7/i|0;if(u<=1)o+=r.Amount,yield{...t,value:o},n++,r.TicDuration>1&&(yield f.DEL(r.TicDuration),n++);else if(r.Amount!==0){const a=r.Amount/u|0;for(let c=0;c<u;c++)o+=a,yield{...t,value:o|0},yield f.DEL(r.TicDuration/u|0),n+=2}else yield f.DEL(r.TicDuration),n++}e.Loop?yield f.HOP(0):yield f.HOP(n)}}}function ne(t){const e=t.get(_.Duration),n=t.get(_.Amount);if(e===null||n===null)return;const i=Number.parseInt(e,16),o=Number.parseInt(n,16),r=t.has(_.Loop);return{Duration:i,Amount:o,Loop:r}}function nn(t,e){e.append(_.Duration,t.Duration.toString(16)),e.append(_.Amount,t.Amount.toString(16)),t.Loop&&e.append(_.Loop,"1")}var _;(t=>{t.Instrument="ins",t.ValueTarget="tgt",t.ValueTargetAmount="tval",t.Kind="knd",t.Attack="att",t.Decay="dec",t.Duration="ln",t.Amount="val",t.Sustain="sus",t.SustainLevel="susv",t.Release="rel",t.Loop="lop",t.SegCount="segs"})(_||(_={}));function on(t){const e=t.get(_.Attack),n=t.get(_.Decay),i=t.get(_.Amount);if(!(e===null||n==null||i==null))return{AttackTics:Number.parseInt(e,16),DecayTics:Number.parseInt(n,16),Amount:Number.parseInt(i,16),Loop:t.has(_.Loop)}}function rn(t,e){e.append(_.Attack,t.AttackTics.toString(16)),e.append(_.Decay,t.DecayTics.toString(16)),e.append(_.Amount,t.Amount.toString(16)),t.Loop&&e.append(_.Loop,"1")}function un(t){const e=t.get(_.Attack),n=t.get(_.SustainLevel),i=t.get(_.Sustain),o=t.get(_.Decay),r=t.get(_.Amount),u=t.get(_.Release);if(!(e===null||o==null||r==null||n==null||u==null||i==null))return{AttackTics:Number.parseInt(e,16),DecayTics:Number.parseInt(o,16),SustainLevel:Number.parseInt(n,16),SustainTics:Number.parseInt(i,16),Amount:Number.parseInt(r,16),ReleaseTics:Number.parseInt(u,16),Loop:t.has(_.Loop)}}function sn(t,e){e.append(_.Attack,t.AttackTics.toString(16)),e.append(_.SustainLevel,t.SustainLevel.toString(16)),e.append(_.Sustain,t.SustainTics.toString(16)),e.append(_.Decay,t.DecayTics.toString(16)),e.append(_.Amount,t.Amount.toString(16)),e.append(_.Release,t.ReleaseTics.toString(16)),t.Loop&&e.append(_.Loop,"1")}function ln(t,e){e.append(_.SegCount,t.Segments.length.toString(16));for(let n=0;n<t.Segments.length;n++){const i=t.Segments[n];e.append(`${_.Amount}${n.toString(16)}`,i.Amount.toString(16)),e.append(`${_.Duration}${n.toString(16)}`,i.TicDuration.toString(16))}t.Loop&&e.append(_.Loop,"1")}function an(t){const e=t.get(_.SegCount);if(e===null)return;const n=Number.parseInt(e,16),i=[];for(let o=0;o<n;o++){const r=t.get(`${_.Amount}${o.toString(16)}`),u=t.get(`${_.Duration}${o.toString(16)}`);if(r===null||u===null)return;i.push({Amount:Number.parseInt(r,16),TicDuration:Number.parseInt(u,16)})}return{Segments:i,Loop:t.has(_.Loop)}}function cn(t){const e=new URLSearchParams;switch(e.append(_.Kind,t.kind),t.kind){case"ad_env":rn(t.def,e);break;case"adsr_env":sn(t.def,e);break;case"tri_lfo":case"square_lfo":case"ramp_up_lfo":case"ramp_down_lfo":nn(t.def,e);break;case"free":ln(t.def,e);break;default:Z()}return e}function dn(t){switch(t.get(_.Kind)){case"ad_env":{const e=on(t);return e!==void 0?{kind:"ad_env",def:e}:void 0}case"adsr_env":{const e=un(t);return e!==void 0?{kind:"adsr_env",def:e}:void 0}case"tri_lfo":{const e=ne(t);return e!==void 0?{kind:"tri_lfo",def:e}:void 0}case"square_lfo":{const e=ne(t);return e!==void 0?{kind:"square_lfo",def:e}:void 0}case"ramp_up_lfo":{const e=ne(t);return e!==void 0?{kind:"ramp_up_lfo",def:e}:void 0}case"ramp_down_lfo":{const e=ne(t);return e!==void 0?{kind:"ramp_down_lfo",def:e}:void 0}case"free":{const e=an(t);return e!==void 0?{kind:"free",def:e}:void 0}default:return}}function fn(t,e){switch(e.kind){case"ad_env":return Zt(t,e.def);case"adsr_env":return Jt(t,e.def);case"tri_lfo":return Xt(t,e.def);case"square_lfo":return Kt(t,e.def);case"ramp_up_lfo":return en(t,e.def);case"ramp_down_lfo":return tn(t,e.def);case"free":return Te(t,e.def);default:Z()}}const _n={free:0,ad_env:1,adsr_env:2,tri_lfo:3,square_lfo:4,ramp_up_lfo:5,ramp_down_lfo:6};function ft(t){switch(t){case 1:return{kind:"ad_env",def:{AttackTics:0,DecayTics:10,Amount:48,Loop:!1}};case 2:return{kind:"adsr_env",def:{AttackTics:7,DecayTics:5,SustainTics:29,ReleaseTics:8,SustainLevel:59,Amount:80,Loop:!1}};case 3:return{kind:"tri_lfo",def:{Duration:40,Amount:62,Loop:!0}};case 4:return{kind:"square_lfo",def:{Duration:40,Amount:62,Loop:!0}};case 5:return{kind:"ramp_up_lfo",def:{Duration:22,Amount:77,Loop:!0}};case 6:return{kind:"ramp_down_lfo",def:{Duration:22,Amount:47,Loop:!0}};case 0:default:return{kind:"free",def:{Segments:[{Amount:40,TicDuration:10}],Loop:!1}}}}var se,O,_e,Re,me=0,_t=[],k=y,$e=k.__b,Fe=k.__r,Ie=k.diffed,Ue=k.__c,Ve=k.unmount,We=k.__;function vt(t,e){k.__h&&k.__h(O,t,me||e),me=0;var n=O.__H||(O.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function vn(t,e){var n=vt(se++,3);!k.__s&&ht(n.__H,e)&&(n.__=t,n.i=e,O.__H.__h.push(n))}function hn(t){return me=5,Oe(function(){return{current:t}},[])}function Oe(t,e){var n=vt(se++,7);return ht(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function pn(){for(var t;t=_t.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(re),t.__H.__h.forEach(Se),t.__H.__h=[]}catch(e){t.__H.__h=[],k.__e(e,t.__v)}}k.__b=function(t){O=null,$e&&$e(t)},k.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),We&&We(t,e)},k.__r=function(t){Fe&&Fe(t),se=0;var e=(O=t.__c).__H;e&&(_e===O?(e.__h=[],O.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(re),e.__h.forEach(Se),e.__h=[],se=0)),_e=O},k.diffed=function(t){Ie&&Ie(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(_t.push(e)!==1&&Re===k.requestAnimationFrame||((Re=k.requestAnimationFrame)||yn)(pn)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),_e=O=null},k.__c=function(t,e){e.some(function(n){try{n.__h.forEach(re),n.__h=n.__h.filter(function(i){return!i.__||Se(i)})}catch(i){e.some(function(o){o.__h&&(o.__h=[])}),e=[],k.__e(i,n.__v)}}),Ue&&Ue(t,e)},k.unmount=function(t){Ve&&Ve(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{re(i)}catch(o){e=o}}),n.__H=void 0,e&&k.__e(e,n.__v))};var Ge=typeof requestAnimationFrame=="function";function yn(t){var e,n=function(){clearTimeout(i),Ge&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,100);Ge&&(e=requestAnimationFrame(n))}function re(t){var e=O,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),O=e}function Se(t){var e=O;t.__c=t.__(),O=e}function ht(t,e){return!t||t.length!==e.length||e.some(function(n,i){return n!==t[i]})}var mn=Symbol.for("preact-signals");function Ce(){if(U>1)U--;else{for(var t,e=!1;j!==void 0;){var n=j;for(j=void 0,ge++;n!==void 0;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&yt(n))try{n.c()}catch(o){e||(t=o,e=!0)}n=i}}if(ge=0,U--,e)throw t}}var g=void 0,j=void 0,U=0,ge=0,le=0;function pt(t){if(g!==void 0){var e=t.n;if(e===void 0||e.t!==g)return e={i:0,S:t,p:g.s,n:void 0,t:g,e:void 0,x:void 0,r:e},g.s!==void 0&&(g.s.n=e),g.s=e,t.n=e,32&g.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=g.s,e.n=void 0,g.s.n=e,g.s=e),e}}function T(t){this.v=t,this.i=0,this.n=void 0,this.t=void 0}T.prototype.brand=mn;T.prototype.h=function(){return!0};T.prototype.S=function(t){this.t!==t&&t.e===void 0&&(t.x=this.t,this.t!==void 0&&(this.t.e=t),this.t=t)};T.prototype.U=function(t){if(this.t!==void 0){var e=t.e,n=t.x;e!==void 0&&(e.x=n,t.e=void 0),n!==void 0&&(n.e=e,t.x=void 0),t===this.t&&(this.t=n)}};T.prototype.subscribe=function(t){var e=this;return Pe(function(){var n=e.value,i=g;g=void 0;try{t(n)}finally{g=i}})};T.prototype.valueOf=function(){return this.value};T.prototype.toString=function(){return this.value+""};T.prototype.toJSON=function(){return this.value};T.prototype.peek=function(){var t=g;g=void 0;try{return this.value}finally{g=t}};Object.defineProperty(T.prototype,"value",{get:function(){var t=pt(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(ge>100)throw new Error("Cycle detected");this.v=t,this.i++,le++,U++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{Ce()}}}});function F(t){return new T(t)}function yt(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function mt(t){for(var e=t.s;e!==void 0;e=e.n){var n=e.S.n;if(n!==void 0&&(e.r=n),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}function St(t){for(var e=t.s,n=void 0;e!==void 0;){var i=e.p;e.i===-1?(e.S.U(e),i!==void 0&&(i.n=e.n),e.n!==void 0&&(e.n.p=i)):n=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=i}t.s=n}function W(t){T.call(this,void 0),this.x=t,this.s=void 0,this.g=le-1,this.f=4}(W.prototype=new T).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===le))return!0;if(this.g=le,this.f|=1,this.i>0&&!yt(this))return this.f&=-2,!0;var t=g;try{mt(this),g=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return g=t,St(this),this.f&=-2,!0};W.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}T.prototype.S.call(this,t)};W.prototype.U=function(t){if(this.t!==void 0&&(T.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};W.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(W.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=pt(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function gt(t){return new W(t)}function At(t){var e=t.u;if(t.u=void 0,typeof e=="function"){U++;var n=g;g=void 0;try{e()}catch(i){throw t.f&=-2,t.f|=8,Me(t),i}finally{g=n,Ce()}}}function Me(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,At(t)}function Sn(t){if(g!==this)throw new Error("Out-of-order effect");St(this),g=t,this.f&=-2,8&this.f&&Me(this),Ce()}function J(t){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}J.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};J.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,At(this),mt(this),U++;var t=g;return g=this,Sn.bind(this,t)};J.prototype.N=function(){2&this.f||(this.f|=2,this.o=j,j=this)};J.prototype.d=function(){this.f|=8,1&this.f||Me(this)};function Pe(t){var e=new J(t);try{e.c()}catch(n){throw e.d(),n}return e.d.bind(e)}var ve;function G(t,e){y[t]=e.bind(null,y[t]||function(){})}function ae(t){ve&&ve(),ve=t&&t.S()}function Lt(t){var e=this,n=t.data,i=An(n);i.value=n;var o=Oe(function(){for(var r=e.__v;r=r.__;)if(r.__c){r.__c.__$f|=4;break}return e.__$u.c=function(){var u;!Ye(o.peek())&&((u=e.base)==null?void 0:u.nodeType)===3?e.base.data=o.peek():(e.__$f|=1,e.setState({}))},gt(function(){var u=i.value.value;return u===0?0:u===!0?"":u||""})},[]);return o.value}Lt.displayName="_st";Object.defineProperties(T.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Lt},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});G("__b",function(t,e){if(typeof e.type=="string"){var n,i=e.props;for(var o in i)if(o!=="children"){var r=i[o];r instanceof T&&(n||(e.__np=n={}),n[o]=r,i[o]=r.peek())}}t(e)});G("__r",function(t,e){ae();var n,i=e.__c;i&&(i.__$f&=-2,(n=i.__$u)===void 0&&(i.__$u=n=function(o){var r;return Pe(function(){r=this}),r.c=function(){i.__$f|=1,i.setState({})},r}())),ae(n),t(e)});G("__e",function(t,e,n,i){ae(),t(e,n,i)});G("diffed",function(t,e){ae();var n;if(typeof e.type=="string"&&(n=e.__e)){var i=e.__np,o=e.props;if(i){var r=n.U;if(r)for(var u in r){var a=r[u];a!==void 0&&!(u in i)&&(a.d(),r[u]=void 0)}else n.U=r={};for(var c in i){var d=r[c],h=i[c];d===void 0?(d=gn(n,c,h,o),r[c]=d):d.o(h,o)}}}t(e)});function gn(t,e,n,i){var o=e in t&&t.ownerSVGElement===void 0,r=F(n);return{o:function(u,a){r.value=u,i=a},d:Pe(function(){var u=r.value.value;i[e]!==u&&(i[e]=u,o?t[e]=u:u?t.setAttribute(e,u):t.removeAttribute(e))})}}G("unmount",function(t,e){if(typeof e.type=="string"){var n=e.__e;if(n){var i=n.U;if(i){n.U=void 0;for(var o in i){var r=i[o];r&&r.d()}}}}else{var u=e.__c;if(u){var a=u.__$u;a&&(u.__$u=void 0,a.d())}}t(e)});G("__h",function(t,e,n,i){(i<3||i===9)&&(e.__$f|=2),t(e,n,i)});Y.prototype.shouldComponentUpdate=function(t,e){var n=this.__$u;if(!(n&&n.s!==void 0||4&this.__$f)||3&this.__$f)return!0;for(var i in e)return!0;for(var o in t)if(o!=="__source"&&t[o]!==this.props[o])return!0;for(var r in this.props)if(!(r in t))return!0;return!1};function An(t){return Oe(function(){return F(t)},[])}function Ln(t,e){const n=ct[t];for(const i of n)for(const o of i)if(o.code===e)return o}function kt(t){const e=new URL(document.location.href).searchParams,n=Vt(e.get(_.Instrument))||"MA",i=dn(e)||ft(2),o=e.get(_.ValueTargetAmount),r=o!==null?Math.max(0,Math.min(255,Number.parseInt(o,10))):80,u=e.get(_.ValueTarget)||"CUT",a=Ln(n,u)||f.CUT(r),c=F({...a,value:r}),d=F(i),h=gt(()=>[...fn(c.value,d.value)]);return{current_instrument:F(n),current_parameter:c,current_macro:d,script:h,midi:t,m8Channel:F(10),m8port:F(void 0)}}let p=kt(void 0);function C(t){const e=o=>{const r=Number.parseInt(o,10);t.update(r)},n=t.max===void 0?255:t.max,i=t.min===void 0?0:t.min;return l("div",{class:"valueEdit",children:[l("label",{children:t.name}),l("br",{}),l("input",{type:"range",min:i,max:n,onInput:o=>e(o.currentTarget.value),value:t.val}),l("input",{type:"number",min:i,max:n,onInput:o=>e(o.currentTarget.value),value:t.val})]})}function kn(t){const e=t.def;return l("form",{children:[l("h3",{children:t.name}),l(C,{name:"Attack (tics)",val:e.AttackTics,update:n=>t.update({...e,AttackTics:n})}),l(C,{name:"Decay (tics)",val:e.DecayTics,update:n=>t.update({...e,DecayTics:n})}),l(C,{name:"Amount",val:e.Amount,update:n=>t.update({...e,Amount:n})}),l("label",{children:"Loop"}),l("input",{type:"checkbox",checked:e.Loop,onInput:n=>t.update({...e,Loop:!e.Loop})})]})}function Dn(t){const e=t.def;return l("form",{children:[l("h3",{children:t.name}),l(C,{name:"Amount",val:e.Amount,update:n=>t.update({...e,Amount:n})}),l(C,{name:"Attack (tics)",val:e.AttackTics,update:n=>t.update({...e,AttackTics:n})}),l(C,{name:"Decay (tics)",val:e.DecayTics,update:n=>t.update({...e,DecayTics:n})}),l(C,{name:"Sustain (tics)",val:e.SustainTics,update:n=>t.update({...e,SustainTics:n})}),l(C,{name:"Sustain Amount",val:e.SustainLevel,update:n=>t.update({...e,SustainLevel:n})}),l(C,{name:"Release (tics)",val:e.ReleaseTics,update:n=>t.update({...e,ReleaseTics:n})}),l("label",{children:"Loop"}),l("input",{type:"checkbox",checked:e.Loop,onInput:n=>t.update({...e,Loop:!e.Loop})})]})}function ie(t){const e=t.def;return l("form",{children:[l("h3",{children:t.name}),l(C,{name:"Duration (tics)",val:e.Duration,update:n=>t.update({...e,Duration:n})}),l(C,{name:"Amount",val:e.Amount,update:n=>t.update({...e,Amount:n}),max:t.maxAmount}),l("label",{children:"Loop"}),l("input",{type:"checkbox",checked:e.Loop,onInput:n=>t.update({...e,Loop:!e.Loop})})]})}function bn(t){const e=t.seg;return l("form",{class:"segmentedit",children:[l(C,{name:"Duration (tics)",val:e.TicDuration,update:n=>t.update({...e,TicDuration:n})}),l(C,{name:"Amount",val:e.Amount,min:-128,max:127,update:n=>t.update({...e,Amount:n})}),l("button",{title:"Remove segment",onClick:()=>t.remove(),children:"Remove"})]})}function Tn(t){const e=t.def,n=()=>t.update({...e,Segments:[...e.Segments,{Amount:10,TicDuration:10}]}),i=e.Segments.map((o,r)=>l(bn,{seg:o,update:c=>{const d=[...e.Segments];d[r]=c,t.update({...e,Segments:d})},remove:()=>{const c=[...e.Segments];c.splice(r,1),t.update({...e,Segments:c})}}));return l("div",{children:[l("h3",{children:t.name}),l("div",{class:"segmentList",children:i}),l("button",{title:"Add a segment",onClick:o=>n(),children:"+"}),l("label",{children:"Loop"}),l("input",{type:"checkbox",checked:e.Loop,onInput:o=>t.update({...e,Loop:!e.Loop})})]})}function qe(t){const e=t.toString(16);return e.length<2?"0"+e:e}function On(t,e){const n=`${qe(t)} : ${e.code} ${qe(e.value)}
`;return t===15?l("span",{class:"warncolor",title:"Beware approaching instruction count limit...",children:n}):t>15?l("span",{class:"errorcolor",title:"Out of bound instruction, cannot be executed.",children:n}):n}function Cn(){const t=p.script.value;return l("pre",{children:t.map((e,n)=>On(n,e))})}function Mn(){const t=p.current_macro.value;switch(t.kind){case"free":return l(Tn,{name:"Free form",def:t.def,update:n=>{const i={...t,def:n};p.current_macro.value=i}});case"ad_env":return l(kn,{name:"Attack Decay Enveloppe",def:t.def,update:n=>{const i={...t,def:n};p.current_macro.value=i}});case"adsr_env":return l(Dn,{name:"ADSR Enveloppe",def:t.def,update:n=>{const i={...t,def:n};p.current_macro.value=i}});case"tri_lfo":return l(ie,{name:"Triangle LFO",def:t.def,update:n=>{const i={...t,def:n};p.current_macro.value=i}});case"square_lfo":return l(ie,{name:"Square LFO",def:t.def,maxAmount:127,update:n=>{const i={...t,def:n};p.current_macro.value=i}});case"ramp_up_lfo":return l(ie,{name:"Ramp UP LFO",def:t.def,update:n=>{const i={...t,def:n};p.current_macro.value=i}});case"ramp_down_lfo":return l(ie,{name:"Ramp Down LFO",def:t.def,update:n=>{const i={...t,def:n};p.current_macro.value=i}});default:Z()}}function Pn(){const t=_n[p.current_macro.value.kind],e=o=>{p.current_macro.value=ft(o)},n=["Free","Attack Decay Env","ADSR Env","Triangle LFO","Square LFO","Ramp up LFO","Ramp down LFO"],i=(o,r)=>l("div",{children:l("label",{children:[l("input",{type:"radio",checked:t===r,onInput:u=>e(r)}),o]})});return l("div",{children:n.map(i)})}function wn(){const t=hn(null),e=p.script.value,n=p.current_parameter.value;return vn(()=>{const i=t.current;if(i===null)return;const o=i.getContext("2d");if(o===null)return;const r=o.canvas.clientWidth,u=o.canvas.clientHeight;o.clearRect(0,0,r,u),o.fillStyle="#555";for(var a=1;a<255;a+=16)o.fillRect(0,a,r,1);o.fillStyle="#080",o.fillRect(0,255-n.value,r,2),o.fillStyle="#fff",Gt(o,n.value,e)},[e]),l("div",{children:l("canvas",{class:"visualization",ref:t,width:640,height:258})})}function xn(){const t=p.current_instrument.value,e=n=>l("div",{children:l("label",{children:[l("input",{type:"radio",value:n,checked:n===t,onInput:i=>p.current_instrument.value=n}),at[n]]})});return l("div",{children:[e("WAV"),e("MA"),e("HS"),e("SA"),e("FM")]})}function En(){const t=p.current_instrument.value,e=p.current_parameter.value,n=ct[t];let i=[];const o=c=>{const d=Number.parseInt(c,10),h=i[d];p.current_parameter.value={...h,value:e.value}};let r=0;const u=c=>(i.push(c),l("option",{value:r++,selected:e.code===c.code,children:[" ",c.code," "]})),a=n.map(c=>l("optgroup",{label:Wt(c[0]),children:c.map(u)}));return l("select",{size:20,onChange:c=>o(c.currentTarget.value),children:a})}function Nn(){const t=p.current_parameter.value;return l(C,{name:"Amount",val:t.value,update:e=>p.current_parameter.value={...t,value:e}})}function Dt(){if(p.midi===void 0)return;const t=be(p.midi,"M8");p.m8port.value=t==null?void 0:t.id}function Hn(){const t=p.m8Channel.value,e=p.m8port.value;if(p.midi===void 0)return l("div",{class:"message",children:"No midi allowed, cannot write to M8, grant MIDI rights and refresh page"});const n=e===void 0?"No connected M8 found":"M8 OK, put cursor in an instrument table for writing.",i=e===void 0?void 0:l("button",{title:"Send CC to the M8 to activate midi mapping",onClick:r=>$n(),children:"CC"}),o=r=>{const u=Number.parseInt(r,10);p.m8Channel.value=u};return l("div",{class:"message",children:[l("span",{class:"midistatus",children:n}),l("span",{class:"separator"}),l("label",{children:[l("span",{class:"midistatus",children:"M8 control channel : "}),l("input",{type:"number",min:"1",max:"16",title:"M8 Midi control channel (10 by default)",value:t,onInput:r=>o(r.currentTarget.value)})]}),l("span",{class:"separator"}),l("button",{title:"Search for M8",onClick:r=>Dt(),children:"⟳ Refresh M8"}),i]})}function Rn(){const t=be(p.midi,"M8");if(t===void 0){p.m8port.value=void 0,alert("No M8 found, please connect and refresh");return}jt(t,p.m8Channel.peek(),p.script.peek())}function $n(){const t=be(p.midi,"M8");if(t===void 0){p.m8port.value=void 0,alert("No M8 found, please connect and refresh");return}zt(t,50,p.m8Channel.peek(),14,64)}function Fn(){const t=p.script.value.length>16,e=p.m8port.value===void 0||t;return l("div",{children:[l("div",{class:"rootheader",children:[l("h1",{children:"M8 Table generator"}),l(Hn,{})]}),l("div",{class:"rootcontainer",children:[l("div",{class:"rootcolumn",children:[l("h3",{children:"Generator"}),l(Pn,{}),l("h3",{children:"Instrument"}),l(xn,{}),l("h3",{children:"Value"}),l(Nn,{}),l(En,{})]}),l("div",{class:"rootcolumn",children:l(Mn,{})}),l("div",{class:"rootcolumn",children:[l("h3",{children:"M8 'script'"}),l(Cn,{}),l(wn,{}),l("div",{children:[l("button",{disabled:e,onClick:n=>Rn(),children:"M8 write"}),t?"Your script is too long and can't be executed on a M8":""]})]})]})]})}function Be(){if(!window.history.pushState)return;var t=new URL(window.location.href);const e=p.current_macro.value;var n=cn(e);n.append(_.Instrument,p.current_instrument.value);const i=p.current_parameter.value;n.append(_.ValueTarget,i.code),n.append(_.ValueTargetAmount,i.value.toString()),t.search=n.toString();const o=t.toString();window.history.replaceState({url:o},"",o)}p=kt(void 0);function In(){p.script.subscribe(Be),p.current_instrument.subscribe(Be),Et(l(Fn,{}),document.getElementById("app"))}document.addEventListener("DOMContentLoaded",function(){In()},!1);try{navigator.requestMIDIAccess().then(t=>{p.midi=t,Dt()})}catch{}
